<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>2. Evaluating the Dynamics · RobotDynamics</title><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit">RobotDynamics</span></div><form class="docs-search" action="search.html"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="index.html">Introduction</a></li><li><span class="tocitem">Getting Started</span><ul><li><a class="tocitem" href="models.html">1. Setting up a Dynamics Model</a></li><li class="is-active"><a class="tocitem" href="dynamics_evaluation.html">2. Evaluating the Dynamics</a><ul class="internal"><li><a class="tocitem" href="#Overview-1"><span>Overview</span></a></li><li><a class="tocitem" href="#Querying-the-Continuous-Dynamics-1"><span>Querying the Continuous Dynamics</span></a></li><li><a class="tocitem" href="#Querying-Discrete-Dynamics-1"><span>Querying Discrete Dynamics</span></a></li><li><a class="tocitem" href="#Other-Methods-1"><span>Other Methods</span></a></li></ul></li></ul></li><li><span class="tocitem">Documentation</span><ul><li><a class="tocitem" href="discretization.html">Discretization</a></li><li><a class="tocitem" href="knotpoints.html"><code>KnotPoint</code> type</a></li><li><a class="tocitem" href="liemodel.html">Models with Rotations</a></li><li><a class="tocitem" href="rigidbody.html">Rigid Bodies</a></li><li><a class="tocitem" href="linearmodel.html">Linear Models</a></li><li><a class="tocitem" href="finite_diff.html">Finite Differencing</a></li><li><a class="tocitem" href="dynamics_api.html">Dynamics API</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Getting Started</a></li><li class="is-active"><a href="dynamics_evaluation.html">2. Evaluating the Dynamics</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="dynamics_evaluation.html">2. Evaluating the Dynamics</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/RoboticExplorationLab/RobotDynamics.jl/blob/master/docs/src/dynamics_evaluation.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="model_section-1"><a class="docs-heading-anchor" href="#model_section-1">2. Evaluating the Dynamics</a><a class="docs-heading-anchor-permalink" href="#model_section-1" title="Permalink"></a></h1><ul><li><a href="dynamics_evaluation.html#model_section-1">2. Evaluating the Dynamics</a></li><ul><li><a href="dynamics_evaluation.html#Overview-1">Overview</a></li><li><a href="dynamics_evaluation.html#Querying-the-Continuous-Dynamics-1">Querying the Continuous Dynamics</a></li><li><a href="dynamics_evaluation.html#Querying-Discrete-Dynamics-1">Querying Discrete Dynamics</a></li><li><a href="dynamics_evaluation.html#Other-Methods-1">Other Methods</a></li></ul></ul><h2 id="Overview-1"><a class="docs-heading-anchor" href="#Overview-1">Overview</a><a class="docs-heading-anchor-permalink" href="#Overview-1" title="Permalink"></a></h2><p>Once we have a model defined as detailed on the previous page, we can query both the continuous and discrete dynamics, and have access to some additional, useful methods.</p><h2 id="Querying-the-Continuous-Dynamics-1"><a class="docs-heading-anchor" href="#Querying-the-Continuous-Dynamics-1">Querying the Continuous Dynamics</a><a class="docs-heading-anchor-permalink" href="#Querying-the-Continuous-Dynamics-1" title="Permalink"></a></h2><p>We can evaluate the continuous dynamics using one of the following methods:</p><pre><code class="language-julia">ẋ = dynamics(model, z)
ẋ = dynamics(model, x, u)
ẋ = dynamics(model, x, u, t)</code></pre><p>where <code>z</code> is an <a href="knotpoints.html#RobotDynamics.AbstractKnotPoint"><code>AbstractKnotPoint</code></a>, <code>x</code> is the <code>n</code>-dimensional state vector, <code>u</code> is the <code>m</code>-dimensional control vector, and <code>t</code> is the positive scalar independent variable, typically time. For best performance, <code>x</code> and <code>u</code> should be <code>SVector</code>s.</p><p>We can evaluate the continuous time dynamics Jacobian using the method</p><pre><code class="language-julia">jacobian!(∇f, model, z)</code></pre><p>where <code>∇f</code> is an <code>n × (n+m)</code> matrix. Note that the Jacobian methods require an <code>AbstractKnotPoint</code>, since this eliminates unnecessary concatenation and subsequent memory allocations when using ForwardDiff.</p><h3 id="The-DynamicsJacobian-type-1"><a class="docs-heading-anchor" href="#The-DynamicsJacobian-type-1">The <code>DynamicsJacobian</code> type</a><a class="docs-heading-anchor-permalink" href="#The-DynamicsJacobian-type-1" title="Permalink"></a></h3><p>While the dynamics Jacobian <code>∇f</code> can be any <code>AbstractMatrix</code>, RobotDynamics provides the <code>DynamicsJacobian</code> type that has some convenient constructors and provides access to the individual partial derivatives:</p><article class="docstring"><header><a class="docstring-binding" id="RobotDynamics.DynamicsJacobian" href="#RobotDynamics.DynamicsJacobian"><code>RobotDynamics.DynamicsJacobian</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">DynamicsJacobian{n,nm,T}</code></pre><p>Custom <code>n × (n+m)</code> matrix specifying a dynamics Jacobian for a forced dynamical system with <code>n</code> states and <code>m</code> controls. The Jacobian is structured as <code>[∂x ∂u]</code> where <code>x</code> and <code>u</code> are the state and control vectors, respectively.</p><p>The <code>DynamicsJacobian</code> <code>D</code> provides access to the partial derivatives <code>A = ∂x</code>  and <code>B = ∂u</code> via direct access <code>D.A</code> and <code>D.B</code>, returning a view into the underlying <code>Matrix</code>, or</p><pre><code class="language-none">RobotDynamics.get_A(D)
RobotDynamics.get_B(D)</code></pre><p>which return an <code>SMatrix</code>. Note that this method should be used with caution for systems with large state and/or control dimensions.</p><p><strong>Constructors</strong></p><pre><code class="language-none">DynamicsJacobian(model::AbstractModel)
DynamicsJacobian(n::Int, m::Int)
DynamicsJacobian(D::StaticMatrix)</code></pre><p>where <code>D</code> is a <code>StaticMatrix</code> of appropriate size. Since <code>DynamicsJacobian</code> implements the <code>StaticMatrix</code> interface, is also supports all the constructors and operations inherent to a <code>StaticMatrix</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/RoboticExplorationLab/RobotDynamics.jl/blob/e0e8fe3e0fb2e4ae98fa55a7e690ab90392cf5d9/src/jacobian.jl#L1-L25">source</a></section></article><h2 id="Querying-Discrete-Dynamics-1"><a class="docs-heading-anchor" href="#Querying-Discrete-Dynamics-1">Querying Discrete Dynamics</a><a class="docs-heading-anchor-permalink" href="#Querying-Discrete-Dynamics-1" title="Permalink"></a></h2><p>The discrete dynamics can be evaluated using methods analogous to those used to evaluate the continuous dynamics, except we now need to specify the integration method and the time step.</p><pre><code class="language-julia">x′ = discrete_dynamics(::Type{Q}, model, z)
x′ = discrete_dynamics(::Type{Q}, model, x, u, t, dt)</code></pre><p>where <code>Q</code> is a <a href="discretization.html#RobotDynamics.QuadratureRule"><code>QuadratureRule</code></a>. See <a href="discretization.html#Discretization-1">Discretization</a> for more information on the integration methods defined in RobotDynamics.</p><p>When evaluating discrete dynamics, one can also use the <code>propagate_dynamics</code> method that updates the state of the next <code>KnotPoint</code>:</p><div class="admonition is-warning"><header class="admonition-header">Missing docstring.</header><div class="admonition-body"><p>Missing docstring for <code>propagate_dynamics</code>. Check Documenter&#39;s build log for details.</p></div></div><p>The discrete dynamics Jacobian is similarly evaluated using</p><pre><code class="language-julia">discrete_jacobian!(::Type{Q}, ∇f, model, z)</code></pre><p>If the integration method is not passed in as the first argument, the default integration method <a href="@ref"><code>RK3</code></a> will be used.</p><h2 id="Other-Methods-1"><a class="docs-heading-anchor" href="#Other-Methods-1">Other Methods</a><a class="docs-heading-anchor-permalink" href="#Other-Methods-1" title="Permalink"></a></h2><p>All <code>AbstractModel</code>s provide a few functions for generating state and control vectors directly from the model:</p><pre><code class="language-julia">x,u = zeros(model)
x,u = rand(model)
x,u = fill(model, value)</code></pre><p>The <code>Base.size</code> method is also overloaded as a shortcut for returning <code>state_dim(model)</code> and <code>control_dim(model)</code> as a tuple:</p><pre><code class="language-julia">n,m = size(model)</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="models.html">« 1. Setting up a Dynamics Model</a><a class="docs-footer-nextpage" href="discretization.html">Discretization »</a></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Tuesday 30 November 2021 12:07">Tuesday 30 November 2021</span>. Using Julia version 1.3.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
